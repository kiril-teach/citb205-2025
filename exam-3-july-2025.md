## Банкова система за трансакции – Контролно 2
---

### **Цел**

Реализирайте система за банкови трансакции, която моделира преводи между сметки, използвайки съвременни практики в C++. Акцентът е върху разделна компилация, полиморфизъм, безопасното управление на паметта, обработката на изключения и предефинирането на операции. **Не използвайте указатели директно, а през smart pointers.**

---

### **1. Основна функционалност**

#### **Управление на сметки**
- **Сметките** се зареждат от текстов файл при стартиране (пътят се подава като първи аргумент от командния ред). Всяка сметка има:
  - **Номер на сметка** (уникален идентификатор)
  - **Вид сметка** "S" за стандартна и "P" за premium
  - **Собственик** (текст, първо име и фамилия)
  - **Баланс** (число)
- **Презареждане на сметки:**  
  - С командата `reload` можете да презаредите сметките от файла по всяко време.  
  - Съществуващите сметки в паметта се обновяват, но историята на трансакции запазва референциите си към оригиналните сметки.

#### **Трансакции**
- **Създаване:**  
  - Потребителят подава трансакция през командния ред с подател, получател и сума. Транзакцията се изпълнява. Грешка при недостатъчна сума.
- **Такса:**  
  - В зависимост от вида сметка (premium или standard) се удържа такса. За premium таксата е 0, за standard таксата е 5% от стойността на транзакцията. Логиката за такса е скрита в член-фунцкия на класа сметка. Използвайте полиморфизъм за да реализирате различно поведение в зависимост от вида сметка.
- **История:**  
  - Запазват се последните 10 трансакции в памет. При добавяне на 11-та – най-старата се премахва, което веднага освобождава референции към остарели сметки.

---

### **2. Изисквания**

#### **Разделна компилация**
- Всеки клас трябва да е реализиран в отделна двойка .cpp и  .h файлове. main.cpp не трябва да съдържа клас дефиниции.
- Предайте само кода на програмата - (.cpp  и .h) файловете.

#### **Капсулация**
- Член-променливите на класовете са частни и се достъпват единствено чрез съответните член-функции за достъп
- Член-функциите за четене работят и върху константни референции на класа.

#### **Полиморфизъм**
- Логиката за удържане на такса трябва да е "скрита" в класа сметка. Използвайте полиморфизъм за целта, където наследници от тип стандартна сметка удържат такса при теглене, докато наследниците на premium - не. Таксата няма нужда да е отразена в трансакцията.

#### **Управление на паметта**
- **Без директни указатели!**
  - Използвайте `std::shared_ptr` за сметките, за да останат валидни, докато има референции в трансакции.
  - Използвайте `std::unique_ptr` за трансакции (те не се копират).
- **Своевременно освобождаване на памет**
  - Паметта на сметки и трансакции се освобождава веднага щом те вече не са необходими за изпълнение на програмата.
- **Без излишно копиране**
  - Трансакциите и сметките се пазят в паметта точно веднъж.

#### **Изключения**
Обработвайте следните грешки чрез **стандартни и собствени изключения**:
- Подаване на трансакция с невалидна/несъществуваща сметка - използвайте стандартен тип изключение
- Недостатъчна наличност по източника при одобрение - използвайте собствен тип изключение. Изключението трябва да се хвърля от член-фунцкията на класа "Сметка" за намаляване на баланса. След това изключение, програмата трябва да отпечата грешка, да премахне трансакцията без да я добавя в историята и да продължи нормално своето изпълнение.

#### **Предефиниране на операции**

- Предефинирайте `<<` за:
    - Печат на детайли за сметка (номер, баланс, собственик, вид)
    - Печат на детайли за трансакция (източник, получател, сума)
- Предефинирайте `+=` и `-=` за увеличаване и намаляване на баланса в сметките.


### **3. CLI Команди и примери**

Програмата трябва да чете команди до края на стандартния вход. Всяка команда е на нов ред. При край на входа, програмата трябва да приключи нормално своето изпълнение. При първоначално стартиране на програмата, тя трябва да направи първото зареждане на сметки от файла, указан като аргумент на командния ред.

| Команда | Описание | Примерен изход |
| :-- | :-- | :-- |
| `submit <src> <dest> <amount>` | Създава нова трансакция (чакаща) | `Transaction 1 submitted (Pending).` |
| `history` | Извежда последните 10 изпълнени трансакции | ```ACC123 -> ACC456: $500.50\nACC654 -> ACC777: $750.00``` |
| `reload` | Презарежда сметките от файл | `Accounts reloaded.` |
| `account <number>` | Показва баланс и собственик на сметка | `Account: ACC123\nOwner: John Doe\nBalance: $2500.00` |

`\n` в примерите означава нов ред в изхода на програмата.

#### **Примери за грешки**

```
> submit ACC999 ACC123 100.00
Error: Account ACC999 does not exist.

> submit ACC999 ACC123 10000.00
Error: Account ACC999 has insufficient funds.

#### **Примерен файл със сметки**
```
ACC123 S John Doe 2000
ACC456 P Jane Doe 500
```